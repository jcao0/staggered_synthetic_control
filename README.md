# Overview

This repository provides replication files for paper Cao, Lu, and Wu (2020), "Synthetic Control Inference for Staggered Adoption."

This package replicates the main results of the paper:

-   **Figure 1** (Section 3: Simulation)

-   **Table 1, Figure 2** and **Figure 3** (Section 4: Intergovernmental coordination and criminality)

------------------------------------------------------------------------

# Data availability

All data sources are publicly available.

The crime and cartel data for Guanajuato used in Section 4 are provided by Alcocer (2024) and are hosted on the Harvard Dataverse ([doi:10.7910/DVN/PBTTDM](https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi%3A10.7910%2FDVN%2FPBTTDM)).

## Statement about Rights

I certify that the author(s) of the manuscript have legitimate access to and permission to use the data used in this manuscript.

------------------------------------------------------------------------

# Replication Instructions

## Section 3: Simulation Study

Access the folder `Simulation` to replicate this section. This section compares staggered synthetic control (SSC) and alternative synthetic control variants through simulation studies.

### Computational requirements

#### Software requirements

-   R (4.5.1)
    -   required packages: R.matlab, doParallel, foreach, doRNG, MASS, nleqslv, dplyr, parallel, gsynth, augsynth, ggplot2, patchwork
    -   All required R packages can be installed by running command `install.packages("package_name")` The exception is augsynth, which should be installed with `devtools::install_github("ebenmichael/augsynth")`.
-   MATLAB (R2018b)
    -   required toolbox: Optimization Toolbox

#### Expected running time

-   Approximate time needed to reproduce the results in this section: 1-2 hours

### Replication Steps

1.  Generate Simulation Datasets:

    -   Run (`sim_sampling.R`) to create simulation datasets.
    -   Output files will be saved in the `data/` directory.

2.  Run Simulations:

    -   Use the MATLAB script (`sim_scs.m`) for SSC results and R scripts (`sim_alternative_methods.R`) for alternative methods.
    -   Output CSV files will be saved in the `output/` directory.

3.  Plot Results:

    -   Use `plot_results.R` to generate **Figure 1** from the simulation results.
    -   **Figure 1** will be saved in `output/` directory

### Detailed Directory Structure

-   `sim_sampling.R` — R script for sampling procedures in simulations.
-   `sim_scs.m` — MATLAB script for simulating staggered synthetic control.
-   `sim_alternative_methods.R` — R script for simulating alternative methods.
-   `plot_results.R` — R script to generate plots from simulation results.
-   `data/` — Contains simulation datasets generated by `sim_sampling.R`:
    -   `sim_data.mat`, `sim_data.RData` — Simulation data in MATLAB and R formats.
-   `functions/` — Contains R and MATLAB functions used in simulations:
    -   `att_ci.m ,` `att_event_ci.m`— MATLAB functions to implement SSC for overall ATT effect and event-time ATT effect with inference
    -   `ssc.m`, `att_event.m` — MATLAB functions to implement SSC for individual treatment effect event-time ATT effect without inference
    -   `synthetic_control.m`,`synthetic_control_batch.m`— MATLAB functions to estimate synthetic control weights for one unit and a batch of units (i.e., all units)
    -   `ssc_inference.m` — MATLAB functions to implement SSC inference
    -   `vline.m` and `vline_license.txt`— MATLAB functions for plotting and related license
    -   `sampling.R` — R functions to generate simulation sample
    -   `padding_matrix.R` — R functions for storing simulation results
    -   `plot.R` — R functions for plotting
-   `output/` — Contains simulation results as CSV files, named by simulation parameters and method (e.g., `sim_results_N33_T15_r3_asy.csv`).

------------------------------------------------------------------------

## Section 4: Intergovernmental Coordination and Criminality

Access the folder `Intergovernmental Coordination and Criminality` to replicate this section. This section revisits the empirical analysis in Alcocer M (2025), “Increasing Intergovernmental Coordination to Fight Crime: Evidence from Mexico.”

The folder includes the data and code needed to reproduce the main tables and figures, specifically:

-   Table 1: Smallest eigenvalues of the sample analogue of the design matrix.

-   Figure 2: Treatment scheme for different outcomes.

-   Figure 3: Treatment effects estimated using staggered synthetic control (SSC) and generalized synthetic control (GSC) methods.

### Computational requirements

#### Software requirements

-   R (4.5.1)
    -   required packages: dplyr, gsynth, panelView, ggplot2, cowplot
-   MATLAB (R2018b)
    -   required toolbox: Optimization Toolbox

#### Expected running time

-   Approximate time needed to reproduce the results in this section: \<10 minutes

### Replication Steps

1.  Prepare cleaned data (R).
    -   Run `data_cleaning.R`.
        -   This script loads the raw data from `raw_data/`, applies the same sample restrictions as in the paper, and writes cleaned CSV files to `smallest_eigenvalues/cleaned_data`, `treatment_effect/cleaned_data`, and `treatment_scheme/cleaned_data`.
2.  Compute smallest eigenvalues of the sample analogue of the design matrices (MATLAB).
    -   Open directory `smallest_eigenvalues/`.
    -   Run `calculate_eigenvalue_for_design_matrix.m` by MATLAB
        -   This script reproduces **Table 1.** It reads the cleaned data and summarize the smallest eigenvalues for each outcome.
    -   **Table 1** will be saved in `smallest_eigenvalues/output/` directory.
3.  Visualize treatment scheme (R):
    -   Open directory `treatment_scheme/`.
    -   Run `plot_treatment_scheme.R` by R
        -   This script reproduces **Figure 2**, which displays the timing of treatment adoption for homicide, theft, and cartel outcomes.
    -   **Figure 2** will be saved in `treatment_scheme/output/` directory.
4.  Estimate treatment effects (R and MATLAB).
    -   Open directory `treatment_effect/`.
    -   Run `estimation_gsc.R` by R.
        -   The script computes the results by GSC method. It uses the "gsynth" package and the cleaned data in `treatment_effect/cleaned_data` to compute event-time ATT estimates and confidence intervals for all outcomes, and saves `results_gsc.csv`.
    -   Run `estimation_ssc.m` by MATLAB.
        -   The script computes the results by SSC method. It uses the SSC functions in `treatment_effect/functions` and the cleaned data in `treatment_effect/cleaned_data` to compute event-time ATT estimates and confidence intervals for all outcomes, and saves `results_ssc.csv`.
    -   Run `plot_results.m` by MATLAB.
        -   This script reproduces **Figure 3** that compares the two methods: it reads `results_ssc.csv` and `results_gsc.csv`, plots figures that compare SSC and GSC event-time ATT estimates across all outcomes.
    -   Estimation results and **Figure 3** will be saved in `treatment_effect/output/` directory.

### Detailed Directory Structure

-   `raw_data/` — Contains the raw data for all analyses.

    -   `psrm_cartel_data.RData` — Annual cartel-related data, obtained from the Dataverse replication archive (doi:10.7910/DVN/PBTTDM).

    -   `psrm_crime_data.RData` — Monthly crime data, obtained from the same Dataverse replication archive.

-   `data_cleaning.R` — R script that processes the raw data in `raw_data/` and saves cleaned data to analysis folders.

-   `smallest_eigenvalues/` — Contains data and code to compute the smallest eigenvalues of the sample analogue of the design matrices and export Table 1.

    -   `cleaned_data/` — Cleaned outcome data produced by `data_cleaning.R`.

        -   `psrm_cartel_data.csv` — Cleaned dataset for cartel outcomes.
        -   `psrm_crime_data.csv` — Cleaned dataset for homicide and theft outcomes.

    -   `calculate_eigenvalue_for_design_matrix.m` — MATLAB code that builds the sample analogue of the design matrices, computes their smallest eigenvalues, and writes the summary table.

    -   `functions/` — MATLAB functions used for implementing SSC method.

        -   `att_ci.m`, `att_event_ci.m` — Implement SSC for overall ATT and event-time ATT effects with inference.
        -   `ssc.m` — Implements SSC for individual treatment effects and event-time ATT without inference.
        -   `synthetic_control.m`, `synthetic_control_batch.m` — Estimate synthetic control weights for one unit and for a batch of units.
        -   `ssc_inference.m` — Implement SSC inference
        -   `vline.m`, `vline_license.txt` — Plotting utility and its license.

    -   `output/` — Output folder for the eigenvalue calculations.

        -   `Table1_smallest_eigenvalue.csv` — Table 1: smallest eigenvalues of the sample analogue of the design matrix for each outcome.

-   `treatment_scheme/` — Contains code and data that produce Figure 2 that visualize the timing of treatment adoption.

    -   `cleaned_data/` — Cleaned outcome data produced by `data_cleaning.R`.
        -   `psrm_cartel_data.csv` — Cleaned dataset for cartel outcomes.
        -   `psrm_crime_data.csv` — Cleaned dataset for homicide and theft outcomes.
    -   `plot_treatment_scheme.R` — Plot the treatment scheme for different outcome groups and save it as Figure 3.
    -   `output/` — Output folder for the treatment scheme figure.
        -   `Figure2_treatment_scheme.png` — Figure that visualizes the treatment scheme for different outcome groups.

-   `treatment_effect/` — Contains data and code to estimate treatment effects and to plot Figure 2.

    -   `cleaned_data/` — Cleaned outcome data produced by `data_cleaning.R`.

        -   `psrm_cartel_data.csv` — Cleaned dataset for cartel outcomes.
        -   `psrm_crime_data.csv` — Cleaned dataset for homicide and theft outcomes.

    -   `estimation_ssc.m` — MATLAB script that estimate treatment effects by SSC method and saves results.

    -   `estimation_gsc.R` — R script that estimate treatment effects by GSC method and saves results.

    -   `plot_results.m` — R script that reads SSC and GSC results and produces Figure 3 that compares the methods.

    -   `functions/` — MATLAB functions used for implementing SSC method.

        -   `att_ci.m`, `att_event_ci.m` — Implement SSC for overall ATT and event-time ATT effects with inference.
        -   `ssc.m` — Implements SSC for individual treatment effects and event-time ATT without inference.
        -   `synthetic_control.m`, `synthetic_control_batch.m` — Estimate synthetic control weights for one unit and for a batch of units.
        -   `ssc_inference.m` — Implement SSC inference
        -   `vline.m`, `vline_license.txt` — Plotting utility and its license.

    -   `output/` — Output folder for the SSC and GSC estimation.

        -   `results_gsc.csv` — Estimated treatment effects by `estimation_gsc.R` and related statistics from the GSC approach.
        -   `results_ssc.csv` — Estimated treatment effects by `estimation_ssc.m` and related statistics from the SSC approach.
        -   `Figure3_application_results.png` — Figure that compares the SSC and GSC approach, produced by `plot_results.m`.

------------------------------------------------------------------------

# Data citations

Alcocer, Marco. 2024. “Replication Data for: Increasing Intergovernmental Coordination to Fight Crime: Evidence from Mexico.” Harvard Dataverse. https://doi.org/10.7910/DVN/PBTTDM.

------------------------------------------------------------------------

# Contact

For questions or comments, please email: [jianfeicao7\@gmail.com](mailto:jianfeicao7@gmail.com)